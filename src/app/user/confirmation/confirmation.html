<div class="payment-page">
  <!-- Header -->
  <div class="section-header">
    <h2>Tên chuyến bay đã chọn</h2>
    <p class="sub">Ngày đi</p>
  </div>


  <div class="payment-container">
    <!-- LEFT COLUMN -->
    <div class="payment-left">
      <h3>Phương thức thanh toán</h3>
      <p class="note">
        Chọn phương thức thanh toán bên dưới. Skyline xử lý thanh toán của bạn một cách an toàn
        với mã hóa đầu cuối.
      </p>


      <div class="method-group">
        <button class="method-btn" [class.active]="paymentMethod() === 'credit'" (click)="selectMethod('credit')">VISA</button>
<button class="method-btn" [class.active]="paymentMethod() === 'google'" (click)="selectMethod('google')">Google Pay</button>
<button class="method-btn" [class.active]="paymentMethod() === 'apple'" (click)="selectMethod('apple')">Apple Pay</button>
<button class="method-btn" [class.active]="paymentMethod() === 'paypal'" (click)="selectMethod('paypal')">Paypal</button>
      </div>


      <!-- FORM CHÍNH -->
      <form #paymentForm="ngForm">
        <div class="payment-details">
          <h4>Chi tiết thẻ thanh toán</h4>


          <label>
            <input type="checkbox" (change)="focusCardName($event)" /> Địa chỉ thanh toán:
          </label>


          <!-- Tên trên thẻ -->
          <div class="form-field">
            <input
              #cardNameInput
              type="text"
              name="nameOnCard"
              [(ngModel)]="nameOnCard"
              placeholder="Tên trên thẻ"
              required
              #cardNameRef="ngModel"
              [class.invalid-field]="cardNameRef.invalid && (cardNameRef.dirty || cardNameRef.touched)"
            />
            <div *ngIf="cardNameRef.invalid && (cardNameRef.dirty || cardNameRef.touched)" class="error-message">
              <span *ngIf="cardNameRef.errors?.['required']">Tên trên thẻ là bắt buộc.</span>
            </div>
          </div>


          <!-- Số thẻ -->
          <div class="form-field">
            <input
              type="text"
              name="cardNumber"
              [(ngModel)]="cardNumber"
              placeholder="Số thẻ"
              required
              #cardNumberRef="ngModel"
              [class.invalid-field]="cardNumberRef.invalid && (cardNumberRef.dirty || cardNumberRef.touched)"
            />
            <div *ngIf="cardNumberRef.invalid && (cardNumberRef.dirty || cardNumberRef.touched)" class="error-message">
              <span *ngIf="cardNumberRef.errors?.['required']">Vui lòng nhập số thẻ.</span>
            </div>
          </div>


          <!-- Hạn và CVV -->
          <div class="form-row">
            <div class="form-field small">
              <input
                type="text"
                name="expiry"
                [(ngModel)]="expiry"
                placeholder="MM/YY"
                required
                #expiryRef="ngModel"
                [class.invalid-field]="expiryRef.invalid && (expiryRef.dirty || expiryRef.touched)"
              />
              <div *ngIf="expiryRef.invalid && (expiryRef.dirty || expiryRef.touched)" class="error-message-small">
                <span *ngIf="expiryRef.errors?.['required']">Hạn là bắt buộc.</span>
              </div>
            </div>


            <div class="form-field small">
              <input
                type="password"
                name="cvv"
                [(ngModel)]="cvv"
                placeholder="CVV"
                required
                #cvvRef="ngModel"
                [class.invalid-field]="cvvRef.invalid && (cvvRef.dirty || cvvRef.touched)"
              />
              <div *ngIf="cvvRef.invalid && (cvvRef.dirty || cvvRef.touched)" class="error-message-small">
                <span *ngIf="cvvRef.errors?.['required']">CVV là bắt buộc.</span>
              </div>
            </div>
          </div>


          <p class="powered"><span>Skyline</span></p>


          <!-- Chính sách -->
          <div class="policy">
            <h4>Chính sách hủy</h4>
            <p>
              Chuyến bay này có chính sách hủy linh hoạt. Nếu bạn hủy hoặc thay đổi chuyến bay trong
              vòng 30 ngày trước ngày khởi hành, bạn sẽ được hoàn tiền miễn phí. Vui lòng xem
              <a href="#">chính sách hủy đầy đủ</a> để biết thêm chi tiết.
            </p>
          </div>


          <div class="action-buttons">
            <button class="btn-secondary" type="button" (click)="backToSeatSelection()">Quay lại</button>
          </div>
        </div>
      </form>
    </div>


    <!-- RIGHT COLUMN -->
    <div class="payment-right">
      <div class="flight-card">
        <div class="flight-item">
          <img src="/assets/logo_skyline.png" alt="plane" />
          <div>
            <p class="airline">Tên hãng bay</p>
            <p class="time">16h 45m (+1d)</p>
            <p class="detail">7:00 AM - 4:15 PM • 2h 45m in HNL</p>
          </div>
        </div>
      </div>


      <div class="summary">
        <div class="row">
          <span>Tạm tính</span>
          <span>0.000.000 đ</span>
        </div>
        <div class="row">
          <span>Thuế và Phí</span>
          <span>000.000 đ</span>
        </div>


        <hr />


        <div class="coupon">
          <input type="text" placeholder="Mã giảm giá" [(ngModel)]="couponCode" />
          <button type="button" (click)="applyCoupon()">Sử dụng</button>
        </div>


        <div class="total">
          <span>Tổng cộng</span>
          <span>0.000.000 đ</span>
        </div>


        <!-- ✅ Nút xác nhận chuyển sang bên phải -->
        <div class="confirm-btn-wrapper">
          <button class="btn-primary" (click)="confirmPayment(paymentForm)">
            Xác nhận và thanh toán
          </button>
        </div>
      </div>
    </div>
  </div>
</div>



